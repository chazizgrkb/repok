{% extends "_layout.twig" %}

{% block title %}Admin panel{% endblock %}

	{% block content %}
		<link href="/img/admin.css" rel="stylesheet" type="text/css">
        <div class="tableSubTitle">Admin panel</div>
        <p>Currently running rePok version {{ version }} (commit {{ git_commit() }}) on {{ operating_system() }}
            . {{ profiler_stats() }}</p>
        <table style="width: 100%;">
            <tr>
                <td class="nb" style="width:33%; vertical-align:top;">
                    <table class="c1">
                        <tr class="h">
                            <td class="b" colspan="2">Latest registered users</td>
                        </tr>
                        {% for user in latest_registered_users %}
                            <tr>
                                <td class="b"><a href="profile.php?user={{ user.name }}">{{ user.name }}</a></td>
                                <td class="b">{{ user.joined | date() }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                </td>
                <td class="nb" style="width:33%; vertical-align:top;">
                    <table class="c1">
                        <tr class="h">
                            <td class="b" colspan="2">Latest seen users</td>
                        </tr>
                        {% for user in latest_seen_users %}
                            <tr>
                                <td class="b"><a href="profile.php?user={{ user.name }}">{{ user.name }}</a></td>
                                <td class="b">{{ user.lastview | relative_time }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                </td>
                <td class="nb" style="width:33%; vertical-align:top;">
                    <table class="c1">
                        <tr class="h">
                            <td class="b" colspan="2">Latest uploaded videos</td>
                        </tr>
                        {% for video in videos %}
                            <tr>
                                <td class="b"><a href="watch.php?v={{ video.video_id }}">{{ video.title }}</td>
                                <td class="b">{{ video.time | relative_time }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                </td>
            </tr>
        </table>
		
		<h3>Comments</h3>
		{% for comment in comments %}
			<div class="commentsEntry">"{{ comment.comment }}"<br> - <a
				href="profile.php?user={{ comment.u_name }}">{{ comment.u_name }}</a> on <a href="/watch.php?v={{ comment.id }}">{{ comment.title }}</a> // <a
				href="profile_videos.php?user={{ comment.u_name }}">Videos</a> ({{ comment.allVideos }})
				| <a href="profile_favorites.php?user={{ comment.u_name }}">Favorites</a>
				({{ comment.allFavorites }}) - ({{ comment.date | relative_time }}) | <a style="color: red;" href="/admin.php?action=delete_comment&id={{ comment.comment_id }}">DELETE!!!!!</a>
            </div>
		{% endfor %}

        <h3>Numbers</h3>

        <table class="pageTable">
            <tr class="h">
                {% for thing in things_to_count %}
                    <td class="b h" width=100>{{ thing | title }}</td>
                {% endfor %}
            </tr>
            <tr>
                {% for thing in things_to_count %}
                    <td class="b">{{ count[thing] }}</td>
                {% endfor %}
            </tr>
        </table>
    {% endblock %}
